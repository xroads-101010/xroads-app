<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xroads.dao.TripMemberDao">

  <select id="getTripMembersByTripId"  parameterType="int" resultMap="tripMemberMap">
    SELECT
      trip_id,
      member_id,
      member_starting_location,
      has_member_joined
    FROM
    `trip_members` tm
    WHERE tm.trip_id = #{tripId}
  </select>

  <insert id="addTripMembers" parameterType="java.util.List" useGeneratedKeys="true"   >
	INSERT INTO trip_members (trip_id, member_id, 
				member_starting_location, has_member_joined)
		VALUES
	<foreach collection="list" item="element" index="index"  separator=","  >
		 ( #{	element.tripId}, #{element.memberId}, 
				#{element.memberStartingLocation}, #{element.hasMemberJoined})
	</foreach>			
 </insert>  
 
 <update id="updateTripMember" parameterType="TripMember">
 	UPDATE 
 		trip_members tm
 	SET
 		tm.member_starting_location = #{memberStartingLocation},
 		tm.has_member_joined = #{hasMemberJoined}
 	WHERE
 		tm.member_id = #{memberId}
 		AND
 		tm.trip_id = #{tripId}
 
 </update>

  <resultMap id="tripMemberMap" type="TripMember">
    <id property="id" column="id" />
    <result property="tripId" column="trip_id" />
    <result property="memberId" column="member_id" />
    <result property="memberStartingLocation" column="member_starting_location" />
    <result property="hasMemberJoined" column="has_member_joined" />
  </resultMap>

 

</mapper>